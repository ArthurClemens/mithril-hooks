!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("mithril")):"function"==typeof define&&define.amd?define(["exports","mithril"],e):e((t=t||self).mithrilHooks=t.mithrilHooks||{},t.m)}(this,function(t,e){"use strict";function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,u=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw u}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i;e=e&&e.hasOwnProperty("default")?e.default:e;var a=Function.prototype.call.bind(Function.prototype.call),s=function(){return e.redraw()},c=function(t){var e=i,r=e.depsIndex++,n=e.depsStates[r]||[],o=void 0===t||!!Array.isArray(t)&&(t.length>0?!t.every(function(t,e){return t===n[e]}):!e.setup);return e.depsStates[r]=t,o},f=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,r){var n=i;if(c(r)){var o=function(){var t=e();"function"==typeof t&&(n.teardowns.set(e,t),n.teardowns.set("_",s))};n.updates.push(t?function(){return new Promise(function(t){return requestAnimationFrame(t)}).then(o)}:o)}}},l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=i,n=r.statesIndex++;return r.setup||(r.states[n]=t),[r.states[n],function(t){var o=r.states[n],u=e(t,n);r.states[n]=u,JSON.stringify(u)!==JSON.stringify(o)&&s()},n]},p=f(!0),d=f(),y=function(t,e){var r=i,n=c(e),u=o(r.setup?l():l(t()),2),a=u[0],s=u[1];return r.setup&&n&&s(t()),a};t.useCallback=function(t,e){return y(function(){return t},e)},t.useEffect=p,t.useLayoutEffect=d,t.useMemo=y,t.useReducer=function(t,e,r){var n,u,a,s,c=i,f=!c.setup&&r?r(e):e;return n=o(l(f),3),u=n[0],a=n[1],s=n[2],[u,function(e){var r=c.states[s];return a(t(r,e))}]},t.useRef=function(t){return o(l({current:t}),1)[0]},t.useState=function(t){var e=i;return l(t,function(t,r){return"function"==typeof t?t(e.states[r]):t})},t.withHooks=function(t,e){var o=function(t){var e=i;i=t.state;try{t.state.updates.forEach(a)}finally{Object.assign(t.state,{setup:!0,updates:[],depsIndex:0,statesIndex:0}),i=e}};return{oninit:function(t){Object.assign(t.state,{setup:!1,states:[],statesIndex:0,depsStates:[],depsIndex:0,updates:[],teardowns:new Map})},oncreate:o,onupdate:o,view:function(o){var u=i;i=o.state;try{return t(function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(o,!0).forEach(function(e){r(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}({},e,{},o.attrs,{vnode:o,children:o.children}))}catch(t){console.error(t)}finally{i=u}},onremove:function(t){var e=i;i=t.state;try{u(t.state.teardowns.values()).forEach(a)}finally{i=e}}}},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mithril-hooks.js.map
